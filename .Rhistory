dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
plots <- list()
i = 0
for(iv in ivs){
after<-list()
year_after<-list()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
append(after, 0)
append(year_after, 0)
}
}
ropes[paste0(dv, "_after")] <- after
ropes[paste0(dv, "_year_after")] <- year_after
}
return(ropes)
}
sds <- read_csv("standarddeviations.csv")
ropesOutput <- rope_dataframe(ivs1)
rlang::last_error()
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
plots <- list()
i = 0
for(iv in ivs){
after<-list()
year_after<-list()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
append(after, 0)
append(year_after, 0)
}
}
ropes[paste0(iv, "_after")] <- after
ropes[paste0(iv, "_year_after")] <- year_after
}
return(ropes)
}
ropesOutput <- rope_dataframe(ivs1)
rlang::last_error()
ropesOutput <- rope_dataframe(ivs2)
rlang::last_error()
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
iv="ls"
after=c(0,0,0,0)
ropes[paste0(iv, "_after")] <- after
View(ropes)
after<-list()
append(after, 0)
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-list()
year_after<-list()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
ropes[paste0(iv, "_after")] <- after
ropes[paste0(iv, "_year_after")] <- year_after
}
return(ropes)
}
ropesOutput <- rope_dataframe(ivs2)
print(year_after)
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-list()
year_after<-list()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
#ropes[paste0(iv, "_after")] <- after
#ropes[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(ropes)
}
ropesOutput <- rope_dataframe(ivs2)
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
#ropes[paste0(iv, "_after")] <- after
#ropes[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(ropes)
}
ropesOutput <- rope_dataframe(ivs2)
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
ropes[paste0(iv, "_after")] <- after
ropes[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(ropes)
}
ropesOutput <- rope_dataframe(ivs2)
ropesOutput <- rope_dataframe(c(ivs1, ivs3, ivs2, ivs4))
?kaggle
??kaggle
knitr::kable(ropesOutput, format="html")
library(knitr)
tab_df(ropesOutput)
tab_df(ropesOutput, file="ropes.html")
pd(model)
str(pd(model))
pd_dataframe <- function(ivs) {
pds <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after")])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
pds[paste0(iv, "_after")] <- after
pds[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(pds)
}
pdsOutput <- pd_dataframe(c(ivs1, ivs3, ivs2, ivs4))
tab_df(pdsOutput, file="pds.html")
pdsOutput <- pd_dataframe(c(ivs1, ivs3, ivs2, ivs4))
pd_dataframe <- function(ivs) {
pds <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after")])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after")])
} else {
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
pds[paste0(iv, "_after")] <- after
pds[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(pds)
}
pdsOutput <- pd_dataframe(c(ivs1, ivs3, ivs2, ivs4))
tab_df(pdsOutput, file="pds.html")
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
ropes[paste0(iv, "_after")] <- after
ropes[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(ropes)
}
sds <- read_csv("standarddeviations.csv")
ropesOutput <- rope_dataframe(c(ivs1, ivs3, ivs2, ivs4))
tab_df(ropesOutput, file="ropes.html")
ivs4 = c("rulPartyChange", "conflict", " ")
iv_realnames4 = c("Ruling Party Changes", "Pre-event Conflict", " ")
plot_page(ivs4, iv_realnames4)
plot_page <- function(ivs, iv_realnames) {
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
plots <- list()
i = 0
for(dv in dvs){
for(iv in ivs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
postsample <- as.data.frame(model, variable=c(paste0("b_after"), paste0("b_year_after")))
p <- ggplot(postsample, aes(x=!!sym(paste0("b_after")), y=!!sym(paste0("b_year_after")))) +
geom_hex() +
geom_hline(yintercept=0, color="maroon") +
geom_vline(xintercept=0, color="maroon") +
theme_anthony() +
theme(legend.position="none",
axis.line.y.left = element_line(size=0.5, color="grey"),
panel.grid.major = element_blank(),
axis.ticks.y = element_line(size=0.5)
)
} else {
postsample <- as.data.frame(model, variable=c(paste0("b_after:", iv), paste0("b_year_after:", iv)))
p <- ggplot(postsample, aes(x=!!sym(paste0("b_after:", iv)), y=!!sym(paste0("b_year_after:", iv)))) +
geom_hex() +
geom_hline(yintercept=0, color="maroon") +
geom_vline(xintercept=0, color="maroon") +
theme_anthony() +
theme(legend.position="none",
axis.line.y.left = element_line(size=0.5, color="grey"),
panel.grid.major = element_blank(),
axis.ticks.y = element_line(size=0.5)
)
}
} else {
p <- ggplot() +
geom_hline(yintercept=0, color="maroon") +
geom_vline(xintercept=0, color="maroon") +
theme_anthony() +
theme(legend.position="none",
axis.line.y.left = element_line(size=0.5, color="grey"),
panel.grid.major = element_blank(),
axis.ticks.y = element_line(size=0.5)
)
}
i = i+1
plots[[i]] <- p
}
}
## Add Row and Column Names
plots[c(1,4,7,10)] = lapply(c(1,4,7,10), function(i){
arrangeGrob(plots[[i]], left=dv_realnames[[((i-1)/3)+1]])
})
plots[1:3] = lapply(1:3, function(i){
arrangeGrob(plots[[i]], top=iv_realnames[[i]])
})
## Plot the page
grid.arrange(grobs=plots)
}
ivs4 = c("rulPartyChange", "conflict", " ")
iv_realnames4 = c("Ruling Party Changes", "Pre-event Conflict", " ")
plot_page(ivs4, iv_realnames4)
pdsOutput <- pd_dataframe(c(ivs1, ivs3, ivs2, ivs4))
tab_df(pdsOutput, file="pds1.html")
## Testing PD for one model:
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-dem_rulingParty-na.rds"))
## Testing PD for one model:
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-na-dem_rulingParty.rds"))
p_d <- pd(model)
summary(p_d)
plot(p_d)
p_d$pd[p_d$Parameter==paste0("b_after:", "dem:rulingParty")]
p_d$pd[p_d$Parameter==paste0("b_year_after:", "dem:rulingParty")]
iv = "dem_rulingParty"
dv = "na"
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
if(iv == ""){
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after")])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after")])
} else {
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after:", iv)])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after:", iv)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv = "dem_rulingParty"
dv = "na"
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv <- gsub("_", ":", iv)
pd <- pd(model)
pd$pd[pd$Parameter==paste0("b_after:", iv)]
after<-c()
after <- append(after, pd$pd[pd$Parameter==paste0("b_after:", iv)])
year_after<-c()
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after:", iv)])
pd_dataframe <- function(ivs) {
pds <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
iv = "dem_rulingParty"
dv = "na"
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv1 <- gsub("_", ":", iv)
if(iv1 == ""){
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after")])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after")])
} else {
pd <- pd(model)
after <- append(after, pd$pd[pd$Parameter==paste0("b_after:", iv1)])
year_after <- append(year_after, pd$pd[pd$Parameter==paste0("b_year_after:", iv1)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
pds[paste0(iv, "_after")] <- after
pds[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(pds)
}
pdsOutput <- pd_dataframe(c(ivs1, ivs3, ivs2, ivs4))
tab_df(pdsOutput, file="pds.html")
## PLOT FOR GETTING ROPE VALUES
rope_dataframe <- function(ivs) {
ropes <- tibble(variables=c("ls", "hope", "pa", "na"))
## Declare Dependent Variables and Names that are constant across all pages
dvs = c("ls", "hope", "pa", "na")
dv_realnames = c("Life Satisfaction", "Hope", "Positive Affect", "Negative Affect")
for(iv in ivs){
after<-c()
year_after<-c()
for(dv in dvs){
if (file.exists(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))){
model <- readRDS(paste0("../BayesOutput/ModeratorAnalysis/model-", dv, "-", iv, ".rds"))
iv1 <- gsub("_", ":", iv)
if(iv1 == ""){
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after")])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after")])
} else {
rope <- rope(model, range=c(as.numeric(sds[sds$variable==dv, "sd"]*0.1),as.numeric(sds[sds$variable==dv, "sd"]*-0.1)), ci=1)
after <- append(after, rope$ROPE_Percentage[rope$Parameter==paste0("b_after:", iv1)])
year_after <- append(year_after, rope$ROPE_Percentage[rope$Parameter==paste0("b_year_after:", iv1)])
}
} else {
after <- append(after, 0)
year_after <- append(year_after, 0)
}
}
ropes[paste0(iv, "_after")] <- after
ropes[paste0(iv, "_year_after")] <- year_after
print(after)
print(year_after)
}
return(ropes)
}
ropesOutput <- rope_dataframe(c(ivs1, ivs3, ivs2, ivs4))
tab_df(ropesOutput, file="ropes.html")
library(ggeffects)
model <- lm(lifesat ~ income, data=simGSOEP)
m <- ggpredict(model, "income [all]")
plot(m, residuals=TRUE)
